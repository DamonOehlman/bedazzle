(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.bedazzle=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var ratchet=require("ratchet");var stylar=require("stylar");var _=require("underscore");var extend=_.extend;var transformProps=["x","y","z","rotate","rx","ry","rz","scale"];var percentageProps=["opacity"];var standardProps=["height","width"];var reStripValue=/^\-?\d+/;function Bedazzler(elements,opts){if(!(this instanceof Bedazzler)){return new Bedazzler(elements,opts)}if(typeof elements=="string"||elements instanceof String){elements=((opts||{}).scope||document).querySelectorAll(elements)}this.elements=[].slice.call(elements);this.rtid=0;this.state={};this.done=[];this.queued=[];this._opts={frameDelay:1e3/60,immediate:false}}module.exports=Bedazzler;var p=Bedazzler.prototype;p.frame=function(action){var ii;var bedazzler=this;var props={elements:[],manualHelpers:[],callbacks:[]};props.transform=new ratchet.Transform;if(this.props){for(ii=this.elements.length;ii--;){props.elements[ii]=_.clone(this.props.elements[ii])||{}}}else{for(ii=this.elements.length;ii--;){props.elements[ii]={}}}this.queued.push(function(){bedazzler.props=props;if(typeof action=="function"){action.call(bedazzler,bedazzler.elements)}return props});if(this._opts.immediate){this._applyChanges()}else{clearTimeout(this.rtid);this.rtid=setTimeout(function(){bedazzler._applyChanges()},this._opts.frameDelay||0)}return this};p.end=function(callback){this.props.callbacks.push(callback);return this};p.loop=function(){var lastFrame=this.queued[this.queued.length-1];if(lastFrame){lastFrame.loop=true}return this};p.manual=function(helper){this.props.manualHelpers.push(helper);return this};p.opts=function(opts){extend(this._opts,opts);return this};p.set=function(name,value){var props=this.props;if(arguments.length===1){this.update(name,true)}else if(_.include(transformProps,name)){this[name].call(this,value,true)}else if(name=="transform"){props.transform=ratchet(value)}else{for(var ii=this.elements.length;ii--;){props.elements[ii][name]=value}}return this};p.update=function(props,absolute){if(props){for(var key in props){if(this[key]){this[key](parseInt(props[key],10)||props[key],absolute)}}}return this};transformProps.forEach(function(key){var targetKeys=[key];var targetSection="translate";var reRotate=/^r(\w)?(?:otate)?$/;var reScale=/^scale(X|Y|Z)?$/;if(reRotate.test(key)){targetKeys=[RegExp.$1||"z"];targetSection="rotate"}if(reScale.test(key)){if(RegExp.$1){targetKeys=RegExp.$1.toLowerCase()}else{targetKeys=["x","y"]}targetSection="scale"}p[key]=function(value,absolute){var xyz=this.props.transform[targetSection],currentVal;targetKeys.forEach(function(targetKey){currentVal=xyz[targetKey].value||0;if(absolute){xyz[targetKey].value=value-currentVal}else{xyz[targetKey].value=currentVal+value}});return this}});_.each(percentageProps,function(key){p[key]=function(value){for(var ii=this.elements.length;ii--;){var targetProp=this.props.elements[ii];var currentVal=targetProp[key]||stylar(this.elements[ii],key)||1;targetProp[key]=currentVal*value}return this}});_.each(standardProps,function(key){p[key]=function(value){for(var ii=this.elements.length;ii--;){var targetProp=this.props.elements[ii];var currentVal=targetProp[key]||stylar(this.elements[ii],key)||"0px";var actualValue=parseFloat(currentVal)||0;var units=value.toString().replace(reStripValue,"")||currentVal.toString().replace(reStripValue,"")||"px";targetProp[key]=actualValue+parseFloat(value)+units}return this}});p._applyChanges=function(){var ii;var element;var props;var frame=this.queued.shift();var bedazzler=this;var transitionDuration;var transitioners=[];var timeout=0;var currentTransform;var newTransform;if(typeof frame!="function"){return}props=frame();props.manualHelpers.forEach(function(helper){helper.call(bedazzler,bedazzler.elements)});for(ii=this.elements.length;ii--;){element=stylar(this.elements[ii]);transitionDuration=parseFloat(element.get("transition-duration"));if(transitionDuration){timeout=Math.max(timeout,transitionDuration*1e3);transitioners.push(this.elements[ii])}if(props.transform){currentTransform=element.get("transform",true);newTransform=currentTransform?ratchet(currentTransform).add(props.transform):props.transform;element.set("transform",newTransform.toString({all:true}))}element.set(props.elements[ii])}this.rtid=0;this.done.push(frame);if(frame.loop){this.queued=this.done.splice(0);console.log(transitioners,timeout)}this._next(transitioners,timeout,props.callbacks||[])};p._next=function(transitioners,timeout,callbacks){var transitionsRemaining=transitioners.length;var bedazzler=this;var listener;function runNext(){if(listener){listener.stop()}_.each(callbacks,function(callback){if(typeof callback=="function"){callback.call(bedazzler,bedazzler.elements)}});bedazzler._applyChanges()}if(transitionsRemaining>0){setTimeout(runNext,(timeout||0)+20)}else if(this.queued.length>0){runNext()}}},{ratchet:2,stylar:7,underscore:8}],2:[function(require,module,exports){"use strict";var RatchetTransform=require("./types/transform");var XYZ=require("./types/xyz");var matchers=require("./matchers");var unitTypes={translate:"px",rotate:"deg",scale:""};function fromString(inputString){var props=new RatchetTransform;var data;function checkMatch(rule){var testString=inputString;var match=rule.regex.exec(testString);while(match){data=data||{};if(typeof rule.extract=="function"){rule.extract(match,data)}else{for(var section in rule){if(section!=="regex"&&typeof rule[section]=="function"){data[section]=rule[section](match)}}}data.units=unitTypes[key];testString=testString.slice(0,match.index)+testString.slice(match.index+match[0].length);if(rule.multi){match=rule.regex.exec(testString)}else{match=null}}if(data){props[key]=new XYZ(key,data);data=undefined}}for(var key in matchers){matchers[key].forEach(checkMatch)}return props}var ratchet=module.exports=function(input){if(typeof input=="string"||input instanceof String){return fromString(input)}};ratchet.fromString=fromString;ratchet.Transform=RatchetTransform;ratchet.XYZ=XYZ},{"./matchers":3,"./types/transform":4,"./types/xyz":6}],3:[function(require,module,exports){"use strict";var TransformValue=require("./types/value");function extractVal(index,expectUnits){return function(match){var units="";if(typeof expectUnits=="undefined"||expectUnits){units=match[index+1]||undefined}return new TransformValue(match[index],units)}}function makeRegex(fnName,params){var regex=fnName+"\\(";(params||"").split(/\s/).forEach(function(param){regex+=matchers[param]});return new RegExp(regex+"\\)")}var matchers={val:"(\\-?[\\d\\.]+)",unit:"([^\\s]*)",",":"\\,\\s*"};exports.translate=[{regex:makeRegex("translate","val unit , val unit"),x:extractVal(1),y:extractVal(3)},{regex:makeRegex("translate(X|Y|Z)","val unit"),extract:function(match,data){data[match[1].toLowerCase()]=extractVal(2)(match)},multi:true},{regex:makeRegex("translate","val unit , val unit , val unit"),x:extractVal(1),y:extractVal(3),z:extractVal(5)}];exports.rotate=[{regex:makeRegex("rotate","val unit"),z:extractVal(1)},{regex:makeRegex("rotate(X|Y|Z)","val unit"),extract:function(match,data){data[match[1].toLowerCase()]=extractVal(2)(match)},multi:true}];exports.scale=[{regex:makeRegex("scale","val"),x:extractVal(1,false),y:extractVal(1,false)},{regex:makeRegex("scale","val , val"),x:extractVal(1,false),y:extractVal(2,false)},{regex:makeRegex("scale(X|Y|Z)","val"),extract:function(match,data){data[match[1].toLowerCase()]=extractVal(2,false)(match)},multi:true}]},{"./types/value":5}],4:[function(require,module,exports){"use strict";var XYZ=require("./xyz");var scaleOps={add:"mul",sub:"div"};function RatchetTransform(opts){if(!(this instanceof RatchetTransform)){return new RatchetTransform(opts)}opts=opts||{};opts.scale=opts.scale||{};opts.scale.units="";opts.scale.defaultValue=1;opts.rotate=opts.rotate||{};opts.rotate.units="deg";this.translate=new XYZ("translate",opts.translate);this.rotate=new XYZ("rotate",opts.rotate);this.scale=new XYZ("scale",opts.scale)}module.exports=RatchetTransform;RatchetTransform.prototype.clone=function(){return new RatchetTransform({translate:this.translate,scale:this.scale,rotate:this.rotate})};RatchetTransform.prototype.toString=function(opts){var output=this.translate.toString(opts);var rotate=this.rotate.toString(opts);var scale=this.scale.toString(opts);if(rotate){output+=(output?" ":"")+rotate}if(scale){output+=(output?" ":"")+scale}return output};["add","sub"].forEach(function(op){RatchetTransform.prototype[op]=function(){var newTransform=new RatchetTransform;newTransform.translate=XYZ.prototype[op].apply(this.translate,Array.prototype.map.call(arguments,function(item){return item.translate}));newTransform.scale=XYZ.prototype[scaleOps[op]].apply(this.scale,Array.prototype.map.call(arguments,function(item){return item.scale}));newTransform.rotate=XYZ.prototype[op].apply(this.rotate,Array.prototype.map.call(arguments,function(item){return item.rotate}));return newTransform}})},{"./xyz":6}],5:[function(require,module,exports){"use strict";function TransformValue(value,units){var parsedVal=parseFloat(value);this.value=isNaN(parsedVal)?value:parsedVal;this.units=units||""}module.exports=TransformValue;TransformValue.prototype.valueOf=function(){return this.value};TransformValue.prototype.toString=function(){return this.value+this.units};TransformValue.prototype.matchingUnits=function(){var match=true;for(var ii=arguments.length;ii--;){match=arguments[ii].units===this.units}return match}},{}],6:[function(require,module,exports){"use strict";var TransformValue=require("./value");function XYZ(type,opts){var defaultUnits;if(!(this instanceof XYZ)){return new XYZ(type,opts)}opts=opts||{};this.type=type;this.defaultValue=opts.defaultValue||0;defaultUnits=(opts.x||{}).units||(opts.y||{}).units||(opts.z||{}).units||opts.units;this.units=typeof defaultUnits!="undefined"?defaultUnits:"px";this.x=new TransformValue(typeof opts.x!="undefined"?opts.x:this.defaultValue,this.units);this.y=new TransformValue(typeof opts.y!="undefined"?opts.y:this.defaultValue,this.units);this.z=new TransformValue(typeof opts.z!="undefined"?opts.z:this.defaultValue,this.units)}module.exports=XYZ;XYZ.prototype.add=function(value){var x=this.x.valueOf();var y=this.y.valueOf();var z=this.z.valueOf();if(typeof value=="number"){x+=value;y+=value;z=z?z+value:0}else{for(var ii=arguments.length;ii--;){x+=arguments[ii].x||0;y+=arguments[ii].y||0;z=z||arguments[ii].z?z+(arguments[ii].z||0):0}}return new XYZ(this.type,{x:x,y:y,z:z,units:this.units})};XYZ.prototype.mul=function(value){var x=this.x.valueOf();var y=this.y.valueOf();var z=this.z?this.z.valueOf():0;if(typeof value=="number"){x*=value;y*=value;z=typeof this.z!="undefined"?z*value:0}else{for(var ii=arguments.length;ii--;){x*=arguments[ii].x;y*=arguments[ii].y;z*=arguments[ii].z}}return new XYZ(this.type,{x:x,y:y,z:z,units:this.units})};["sub","div"].forEach(function(op){var isSub=op==="sub";var mappedKey=isSub?"add":"mul";XYZ.prototype[op]=function(value){if(typeof value=="number"){return this[mappedKey](isSub?-value:1/value)}else{var xyz=this;var args=Array.prototype.map.call(arguments,function(item){var inverted=new XYZ(xyz.type,item);if(isSub){inverted.x=-inverted.x;inverted.y=-inverted.y;inverted.z=-inverted.z}else{inverted.x=1/inverted.x;inverted.y=1/inverted.y;inverted.z=inverted.z?1/inverted.z:0}return inverted});return this[mappedKey].apply(this,args)}}});XYZ.prototype.toString=function(opts){var output=[];opts=opts||{};if(opts.all||this.x.value!=this.defaultValue){output[output.length]=this.type+"X("+this.x.value+this.x.units+")"}if(opts.all||this.y.value!=this.defaultValue){output[output.length]=this.type+"Y("+this.y.value+this.y.units+")"}if(opts.all||this.z.value!=this.defaultValue){output[output.length]=this.type+"Z("+this.z.value+this.z.units+")"}return output.join(" ")}},{"./value":5}],7:[function(require,module,exports){(function(root,factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define([],factory)}else{root["stylar"]=factory()}})(this,function(){var prefixes=["ms","o","Moz","webkit",""],knownKeys={},getComputed=null,reDash=/^(\w+)\-(\w)/,reVendorPrefixes=/^\-\w+\-/;if(document.defaultView&&typeof document.defaultView.getComputedStyle=="function"){getComputed=document.defaultView.getComputedStyle}function sniffProperty(element,attribute){var dashMatch,ii,prefix,prefixedAttr;attribute=attribute.replace(reVendorPrefixes,"");dashMatch=reDash.exec(attribute);while(dashMatch){attribute=dashMatch[1]+dashMatch[2].toUpperCase()+attribute.slice(dashMatch[0].length);dashMatch=reDash.exec(attribute)}for(ii=prefixes.length;ii--;){prefix=prefixes[ii];prefixedAttr=prefix?prefix+attribute[0].toUpperCase()+attribute.slice(1):attribute;if(typeof element.style[prefixedAttr]!="undefined"){return knownKeys[attribute]=prefixedAttr}}return attribute}function stylar(elements,attribute,value){var helpers={get:getter,set:setter};if(typeof elements=="string"||elements instanceof String){elements=document.querySelectorAll(elements)}else if(typeof elements.length=="undefined"){elements=[elements]}function getter(attr,ignoreComputed){var readKey,style;readKey=knownKeys[attr]||sniffProperty(elements[0],attr);if(getComputed&&!ignoreComputed){style=getComputed.call(document.defaultView,elements[0])}else{style=elements[0].style}return style?style[readKey]:""}function setter(attr,val){if(typeof attr=="object"&&!(attr instanceof String)){for(var key in attr){setter(key,attr[key])}}else{var styleKey=knownKeys[attr]||sniffProperty(elements[0],attr);for(var ii=elements.length;ii--;){elements[ii].style[styleKey]=val}}return helpers}if(typeof attribute=="undefined"){return helpers}else if(typeof value!="undefined"){return setter(attribute,value)}else{return getter(attribute)}}stylar.sniffProperty=sniffProperty;return typeof stylar!="undefined"?stylar:undefined})},{}],8:[function(require,module,exports){(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.8.2";var optimizeCb=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};var cb=function(value,context,argCount){if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value))return _.matcher(value);return _.property(value)};_.iteratee=function(value,context){return cb(value,context,Infinity)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!undefinedOnly||obj[key]===void 0)obj[key]=source[key]}}return obj}};var baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var isArrayLike=function(collection){var length=collection&&collection.length;return typeof length=="number"&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj)}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj)}}return obj};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir}return iterator(obj,iteratee,memo,keys,index,length)}}_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var key;if(isArrayLike(obj)){key=_.findIndex(obj,predicate,context)}else{key=_.findKey(obj,predicate,context)}if(key!==void 0&&key!==-1)return obj[key]};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.includes=_.include=function(obj,target,fromIndex){if(!isArrayLike(obj))obj=_.values(obj);return _.indexOf(obj,target,typeof fromIndex=="number"&&fromIndex)>=0};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return func==null?func:func.apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=value;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed}})}return result};_.shuffle=function(obj){var set=isArrayLike(obj)?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index)shuffled[index]=shuffled[rand];shuffled[rand]=set[index]}return shuffled};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1});_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?obj.length:_.keys(obj).length};_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[0];return _.initial(array,array.length-n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){var output=[],idx=0;for(var i=startIndex||0,length=input&&input.length;i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(!shallow)value=flatten(value,shallow,strict);var j=0,len=value.length;output.length+=len;while(j<len){output[idx++]=value[j++]}}else if(!strict){output[idx++]=value}}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false)};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(array==null)return[];if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=cb(iteratee,context);var result=[];var seen=[];for(var i=0,length=array.length;i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){if(!i||seen!==computed)result.push(value);seen=computed}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value)}}else if(!_.contains(result,value)){result.push(value)}}return result};_.union=function(){return _.uniq(flatten(arguments,true,true))};_.intersection=function(array){if(array==null)return[];var result=[];var argsLength=arguments.length;for(var i=0,length=array.length;i<length;i++){var item=array[i];if(_.contains(result,item))continue;for(var j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break}if(j===argsLength)result.push(item)}return result};_.difference=function(array){var rest=flatten(arguments,true,true,1);return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){return _.unzip(arguments)};_.unzip=function(array){var length=array&&_.max(array,"length").length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index)}return result};_.object=function(list,values){var result={};for(var i=0,length=list&&list.length;i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){var i=0,length=array&&array.length;if(typeof isSorted=="number"){i=isSorted<0?Math.max(0,length+isSorted):isSorted}else if(isSorted&&length){i=_.sortedIndex(array,item);return array[i]===item?i:-1}if(item!==item){return _.findIndex(slice.call(array,i),_.isNaN)}for(;i<length;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){var idx=array?array.length:0;if(typeof from=="number"){idx=from<0?idx+from+1:Math.min(idx,from+1)}if(item!==item){return _.findLastIndex(slice.call(array,0,idx),_.isNaN)}while(--idx>=0)if(array[idx]===item)return idx;return-1};function createIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=array!=null&&array.length;var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array))return index}return-1}}_.findIndex=createIndexFinder(1);_.findLastIndex=createIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=array.length;while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start}return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2);var bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound};_.partial=function(func){var boundArgs=slice.call(arguments,1);var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i]}while(position<arguments.length)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj)}return obj};_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=""+(hasher?hasher.apply(this,arguments):key);if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};return function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>=0){timeout=setTimeout(later,wait-last)}else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout)context=args=null}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout)timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);context=args=null}return result}};_.wrap=function(func,wrapper){return _.partial(wrapper,func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments)}if(times<=1)func=null;return memo}};_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString");var nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=_.isFunction(constructor)&&constructor.prototype||ObjProto;var prop="constructor";if(_.has(obj,prop)&&!_.contains(keys,prop))keys.push(prop);while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)){keys.push(prop)}}}_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={},currentKey;for(var index=0;index<length;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;
for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};_.pick=function(object,oiteratee,context){var result={},obj=object,iteratee,keys;if(obj==null)return result;if(_.isFunction(oiteratee)){keys=_.allKeys(obj);iteratee=optimizeCb(oiteratee,context)}else{keys=flatten(arguments,false,false,1);iteratee=function(value,key,obj){return key in obj};obj=Object(obj)}for(var i=0,length=keys.length;i<length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj))result[key]=value}return result};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee)){iteratee=_.negate(iteratee)}else{var keys=_.map(flatten(arguments,false,false,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)};_.defaults=createAssigner(_.allKeys,true);_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false}return true};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case"[object RegExp]":case"[object String]":return""+a===""+b;case"[object Number]":if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays=className==="[object Array]";if(!areArrays){if(typeof a!="object"||typeof b!="object")return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&("constructor"in a&&"constructor"in b)){return false}}aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b}aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--){if(!eq(a[length],b[length],aStack,bStack))return false}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=keys[length];if(!(_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false}}aStack.pop();bStack.pop();return true};_.isEqual=function(a,b){return eq(a,b)};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj};_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return _.has(obj,"callee")}}if(typeof/./!="function"&&typeof Int8Array!="object"){_.isFunction=function(obj){return typeof obj=="function"||false}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};_.property=function(key){return function(obj){return obj==null?void 0:obj[key]}};_.propertyOf=function(obj){return obj==null?function(){}:function(key){return obj[key]}};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs)}};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match]};var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(object,property,fallback){var value=object==null?void 0:object[property];if(value===void 0){value=fallback}return _.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}else if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}else if(evaluate){source+="';\n"+evaluate+"\n__p+='"}return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}var template=function(data){return render.call(this,data,_)};var argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(_,args))}})};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0)delete obj[0];return result(this,obj)}});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return""+this._wrapped};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return _})}}).call(this)},{}]},{},[1])(1)});